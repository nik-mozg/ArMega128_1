# README.md

## Описание

Этот проект представляет собой прошивку для микроконтроллера ATmega128, написанную на языке C. Проект включает в себя функции для работы с UART, SPI и АЦП. Основная задача прошивки — взаимодействие с внешним оборудованием через UART и SPI интерфейсы, а также выполнение операций по преобразованию аналоговых сигналов в цифровые.

## Функционал

1. **Настройка UART**: 
   - Настроен COM порт для передачи и приема данных на скорости 9600 бод.
   - Реализованы функции для отправки и получения данных через UART.

2. **Настройка SPI**:
   - Инициализация SPI в режиме мастер.
   - Функции для отправки и получения байтов данных через SPI.

3. **Аналого-Цифровое Преобразование (АЦП)**:
   - Инициализация АЦП.
   - Функция для выполнения преобразования и получения результата.

4. **Основная логика**:
   - Обработка команд, полученных через UART.
   - Управление портами и выполнение операций в зависимости от полученных команд.

5. **Прерывания**:
   - Обработка прерываний от UART для получения данных.

## Установка и сборка

1. **Подключение**: Подключите микроконтроллер ATmega128 к программатору и загрузите прошивку.

2. **Сборка**:
   - Используйте подходящий компилятор для сборки кода. Рекомендуется использовать [avr-gcc](https://www.nongnu.org/avr-libc/).
   - Пример команды для сборки:
     ```bash
     avr-gcc -mmcu=atmega128 -Os -o firmware.elf main.c
     avr-objcopy -O ihex firmware.elf firmware.hex
     ```

3. **Загрузка**:
   - Загрузите прошивку на микроконтроллер с помощью программатора (например, avrdude).
   - Пример команды для загрузки:
     ```bash
     avrdude -c <programmer> -p m128 -U flash:w:firmware.hex:i
     ```

## Структура проекта

- `main.c` — Основной исходный файл с реализацией функций и логики работы микроконтроллера.
- `avr/iom128.h` — Заголовочный файл для работы с регистрами ATmega128.

## Основные функции

- `UARTInit(void)` — Настройка UART для передачи и приема данных.
- `SPI_send_byte(char data)` — Отправка байта данных через SPI.
- `SPI_get_byte(void)` — Получение байта данных через SPI.
- `UARTSend(uint8_t data)` — Отправка байта данных через UART.
- `UARTGet(void)` — Получение байта данных через UART.
- `ADC_Init(void)` — Инициализация АЦП.
- `AD_Converter(void)` — Выполнение преобразования и получение результата.
- `SPI_unit(void)` — Настройка SPI.

## Использование

Прошивка ожидает команды через UART и выполняет соответствующие действия:

- Команды для управления параллельными каналами и АЦП.
- Передача данных через SPI в зависимости от полученных команд.

## Прерывания

Прерывание по приему данных через UART используется для обновления флага и хранения полученных данных.

## Контакт

Если у вас есть вопросы или предложения, вы можете связаться с автором проекта через GitHub.
